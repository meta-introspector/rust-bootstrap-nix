use std::collections::HashSet;
use split_expanded_lib::{DeclarationItem};

fn get_rustc_info () -> Result < RustcInfo > { let output = Command :: new ("rustc") . arg ("--version") . arg ("--verbose") . output () ? ; if ! output . status . success () { return :: anyhow :: __private :: Err (:: anyhow :: Error :: msg (:: alloc :: __export :: must_use ({ :: alloc :: fmt :: format (format_args ! ("rustc --version --verbose failed: {0}" , String :: from_utf8_lossy (& output . stderr) ,) ,) }) ,) ,) ; } let stdout = String :: from_utf8_lossy (& output . stdout) ; let version_line = stdout . lines () . find (| line | line . starts_with ("rustc ")) ; let host_line = stdout . lines () . find (| line | line . starts_with ("host: ")) ; let version = version_line . and_then (| line | line . split_whitespace () . nth (1)) . unwrap_or ("unknown") . to_string () ; let host = host_line . and_then (| line | line . split_whitespace () . nth (1)) . unwrap_or ("unknown") . to_string () ; Ok (RustcInfo { version , host }) }