use std::collections::HashSet;
use split_expanded_lib::{DeclarationItem};

pub fn test_generate_report_with_results () -> Result < () > { let dir = tempdir () ? ; let original_dir = std :: env :: current_dir () ? ; std :: env :: set_current_dir (& dir) ? ; let results = < [_] > :: into_vec (:: alloc :: boxed :: box_new ([FileProcessingResult { path : PathBuf :: from ("src/file1.rs") , status : FileProcessingStatus :: Success , } , FileProcessingResult { path : PathBuf :: from ("src/file2.rs") , status : FileProcessingStatus :: Skipped { reason : "already processed" . to_string () , } , } , FileProcessingResult { path : PathBuf :: from ("src/file3.rs") , status : FileProcessingStatus :: Failed { error : "syntax error" . to_string () , } , } ,]) ,) ; super :: report :: generate_report (& results) ? ; let report_path = dir . path () . join ("prelude_generator_summary.md") ; if ! report_path . exists () { :: core :: panicking :: panic ("assertion failed: report_path.exists()") } let content = fs :: read_to_string (& report_path) ? ; if ! content . contains ("# Prelude Generation Summary Report") { :: core :: panicking :: panic ("assertion failed: content.contains(\"# Prelude Generation Summary Report\")" ,) } if ! content . contains ("- Total files processed: 3") { :: core :: panicking :: panic ("assertion failed: content.contains(\"- Total files processed: 3\")" ,) } if ! content . contains ("- Successfully processed: 1") { :: core :: panicking :: panic ("assertion failed: content.contains(\"- Successfully processed: 1\")" ,) } if ! content . contains ("- Skipped: 1") { :: core :: panicking :: panic ("assertion failed: content.contains(\"- Skipped: 1\")" ,) } if ! content . contains ("- Failed: 1") { :: core :: panicking :: panic ("assertion failed: content.contains(\"- Failed: 1\")" ,) } if ! content . contains ("### src/file1.rs\n- Status: ✅ Successfully Processed") { :: core :: panicking :: panic ("assertion failed: content.contains(\"### src/file1.rs\\n- Status: \u{2705} Successfully Processed\")" ,) } if ! content . contains ("### src/file2.rs\n- Status: ⏭️ Skipped (Reason: already processed" ,) { :: core :: panicking :: panic ("assertion failed: content.contains(\"### src/file2.rs\\n- Status: \u{23ed}\u{fe0f} Skipped (Reason: already processed\")" ,) } if ! content . contains ("### src/file3.rs\n- Status: ❌ Failed (Error: syntax error") { :: core :: panicking :: panic ("assertion failed: content.contains(\"### src/file3.rs\\n- Status: \u{274c} Failed (Error: syntax error\")" ,) } std :: env :: set_current_dir (& original_dir) ? ; Ok (()) }