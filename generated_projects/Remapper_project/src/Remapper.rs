use std::collections::HashSet;
use split_expanded_lib::{DeclarationItem};

# [doc = " Remapper is an abstraction the manages the remapping of state IDs in a"] # [doc = " finite state machine. This is useful when one wants to shuffle states into"] # [doc = " different positions in the machine."] # [doc = ""] # [doc = " One of the key complexities this manages is the ability to correctly move"] # [doc = " one state multiple times."] # [doc = ""] # [doc = " Once shuffling is complete, `remap` must be called, which will rewrite"] # [doc = " all pertinent transitions to updated state IDs. Neglecting to call `remap`"] # [doc = " will almost certainly result in a corrupt machine."] pub (crate) struct Remapper { # [doc = " A map from the index of a state to its pre-multiplied identifier."] # [doc = ""] # [doc = " When a state is swapped with another, then their corresponding"] # [doc = " locations in this map are also swapped. Thus, its new position will"] # [doc = " still point to its old pre-multiplied StateID."] # [doc = ""] # [doc = " While there is a bit more to it, this then allows us to rewrite the"] # [doc = " state IDs in a DFA's transition table in a single pass. This is done"] # [doc = " by iterating over every ID in this map, then iterating over each"] # [doc = " transition for the state at that ID and re-mapping the transition from"] # [doc = " `old_id` to `map[dfa.to_index(old_id)]`. That is, we find the position"] # [doc = " in this map where `old_id` *started*, and set it to where it ended up"] # [doc = " after all swaps have been completed."] map : Vec < StateID > , # [doc = " A way to map indices to state IDs (and back)."] idx : IndexMapper , }