pub fn create_orphan_branch (repo_path : & str , branch_name : & str) -> Result < () > { let repo = Repository :: open (repo_path) ? ; { { let lvl = :: log :: Level :: Info ; if lvl <= :: log :: STATIC_MAX_LEVEL && lvl <= :: log :: max_level () { :: log :: __private_api :: log ({ :: log :: __private_api :: GlobalLogger } , format_args ! ("Creating orphan branch \'{0}\' in repo at \'{1}\'" , branch_name , repo_path ,) , lvl , & ("bootstrap_config_builder::utils::git" , "bootstrap_config_builder::utils::git" , :: log :: __private_api :: loc () ,) , () ,) ; } } } ; let head = repo . head () ? ; let head_commit = head . peel_to_commit () ? ; let signature = Signature :: now ("bootstrap-config-generator" , "bootstrap-config-generator@example.com" ,) ? ; let tree_id = Oid :: from_str ("4b825dc642cb6eb9a060e54bf8d69288fbee4904") ? ; let tree = repo . find_tree (tree_id) ? ; let commit_id = repo . commit (Some ("HEAD") , & signature , & signature , "Initial commit for orphan branch" , & tree , & [& head_commit] ,) ? ; repo . branch (branch_name , & repo . find_commit (commit_id) ? , true) ? ; Ok (()) }