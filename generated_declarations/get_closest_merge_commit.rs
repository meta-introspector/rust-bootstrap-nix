# [doc = " Searches for the nearest merge commit in the repository that also exists upstream."] # [doc = ""] # [doc = " If it fails to find the upstream remote, it then looks for the most recent commit made"] # [doc = " by the merge bot by matching the author's email address with the merge bot's email."] pub fn get_closest_merge_commit (git_dir : Option < & Path > , config : & GitConfig < '_ > , target_paths : & [PathBuf] ,) -> Result < String , String > { let mut git = Command :: new ("git") ; if let Some (git_dir) = git_dir { git . current_dir (git_dir) ; } let merge_base = git_upstream_merge_base (config , git_dir) . unwrap_or_else (| _ | "HEAD" . into ()) ; git . args (["rev-list" , & :: alloc :: __export :: must_use ({ :: alloc :: fmt :: format (format_args ! ("--author={0}" , config . git_merge_commit_email) ,) }) , "-n1" , "--first-parent" , & merge_base ,]) ; if ! target_paths . is_empty () { git . arg ("--") . args (target_paths) ; } Ok (output_result (& mut git) ? . trim () . to_owned ()) }