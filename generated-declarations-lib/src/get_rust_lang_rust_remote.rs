# [doc = " Finds the remote for rust-lang/rust."] # [doc = " For example for these remotes it will return `upstream`."] # [doc = " ```text"] # [doc = " origin  https://github.com/Nilstrieb/rust.git (fetch)"] # [doc = " origin  https://github.com/Nilstrieb/rust.git (push)"] # [doc = " upstream        https://github.com/rust-lang/rust (fetch)"] # [doc = " upstream        https://github.com/rust-lang/rust (push)"] # [doc = " ```"] pub fn get_rust_lang_rust_remote (config : & GitConfig < '_ > , git_dir : Option < & Path > ,) -> Result < String , String > { let mut git = Command :: new ("git") ; if let Some (git_dir) = git_dir { git . current_dir (git_dir) ; } git . args (["config" , "--local" , "--get-regex" , "remote\\..*\\.url"]) ; let stdout = output_result (& mut git) ? ; let rust_lang_remote = stdout . lines () . find (| remote | remote . contains (config . git_repository)) . ok_or_else (| | :: alloc :: __export :: must_use ({ :: alloc :: fmt :: format (format_args ! ("{0} remote not found" , config . git_repository) ,) })) ? ; let remote_name = rust_lang_remote . split ('.') . nth (1) . ok_or_else (| | "remote name not found" . to_owned ()) ? ; Ok (remote_name . into ()) }